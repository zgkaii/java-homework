# 作业1

**题目描述**：使 Java 里的动态代理，实现一个简单的 AOP。

------

1. 创建接口UserDao

```java
public interface UserDao {

    public void add();// 添加

    public void delete();// 删除
}
```

2. 创建实现类 UserDaoImpl

```java
public class UserDaoImpl implements UserDao {
    @Override
    public void add() {
        System.out.println("添加用户");
    }

    @Override
    public void delete() {
        System.out.println("删除用户");
    }
}
```

3. 创建切面类

```java
public class MyAspect {
    public void myBefore() {
        System.out.println("方法执行之前...");
    }
    public void myAfter() {
        System.out.println("方法执行之后...");
    }
}
```

4. 创建代理类 JdkBeanFactory

```java
public class JdkBeanFactory {
    public static UserDao getBean() {
        // 准备目标类
        final UserDaoImpl userDao = new UserDaoImpl();
        // 创建切面类实例
        final MyAspect myAspect = new MyAspect();
        // 使用代理类，进行增强
        return (UserDao) Proxy.newProxyInstance(JdkBeanFactory.class.getClassLoader(),
                new Class[]{UserDao.class}, new InvocationHandler() {
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        myAspect.myBefore(); // 前增强
                        Object obj = method.invoke(userDao, args);
                        myAspect.myAfter(); // 后增强
                        return obj;
                    }
                });
    }
}
```

5. 创建测试类 JDKProxyTests

```java
class JdkProxyTests {

    @Test
    public void test() {
        // 从工厂获得指定的内容（相当于spring获得，但此内容时代理对象）
        UserDao userDao = JdkBeanFactory.getBean();
        // 执行方法
        userDao.add();
        userDao.delete();
    }
}
```

执行结果：

```java
方法执行之前...
添加用户
方法执行之后...
方法执行之前...
删除用户
方法执行之后...
```
